# PECU Premium - Lemon Squeezy Configuration Guide

Este archivo contiene las configuraciones necesarias para Lemon Squeezy para integrar correctamente con PECU Premium.

## Configuraci√≥n del Producto

### Informaci√≥n B√°sica
- **Nombre del Producto**: PECU Premium
- **Descripci√≥n**: Unlock advanced features and priority support for Proxmox Enhanced Configuration Utility
- **Generate License Keys**: ‚úÖ ON (Obligatorio)

### Variantes de Precios

#### Monthly Plan
- **Nombre**: PECU Premium Monthly
- **Precio**: ‚Ç¨3,99
- **Intervalo**: 1 Month
- **Recurring**: Yes

#### Annual Plan  
- **Nombre**: PECU Premium Annual
- **Precio**: ‚Ç¨14,99  
- **Intervalo**: 1 Year
- **Recurring**: Yes

## Configuraci√≥n del Modal de Confirmaci√≥n

### Button Text
```
Access Premium
```

### Button URL
```
https://pecu.tools/premium?license=[license_key]&email=[email]&order_id=[order_id]
```

## Configuraci√≥n del Email Receipt

### Email Template
A√±adir al template del email:

```html
<div style="text-align: center; margin: 30px 0;">
  <h2>üéâ Welcome to PECU Premium!</h2>
  <p>Your license key: <strong style="font-family: monospace; background: #f5f5f5; padding: 5px 10px; border-radius: 4px;">[license_key]</strong></p>
  
  <a href="https://pecu.tools/premium?license=[license_key]&email=[email]&order_id=[order_id]" 
     style="display: inline-block; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; text-decoration: none; padding: 15px 30px; border-radius: 8px; 
            font-weight: bold; margin: 20px 0;">
    üöÄ Get Started with Premium
  </a>
  
  <p style="color: #666; font-size: 14px;">
    Use this link to validate your license and get installation instructions.
  </p>
</div>
```

## Webhooks Configuration

### Webhook URL
```
https://api.pecu.tools/webhooks/lemonsqueezy
```

### Events to Subscribe
- ‚úÖ order_created
- ‚úÖ order_refunded
- ‚úÖ subscription_created
- ‚úÖ subscription_updated
- ‚úÖ subscription_cancelled
- ‚úÖ subscription_resumed
- ‚úÖ subscription_expired
- ‚úÖ subscription_paused
- ‚úÖ subscription_unpaused
- ‚úÖ license_key_created

### Webhook Security
- **Signing Secret**: [Generated by Lemon Squeezy]
- **Verify signatures**: ‚úÖ ON

## URLs para Checkout

### Monthly Plan
```
https://danilop95.lemonsqueezy.com/checkout/buy/[MONTHLY_VARIANT_ID]
```

### Annual Plan  
```
https://danilop95.lemonsqueezy.com/checkout/buy/[ANNUAL_VARIANT_ID]
```

## Configuraci√≥n de License Keys

### Key Format
- **Prefix**: PECU-
- **Length**: 20 characters (PECU-XXXX-XXXX-XXXX-XXXX)
- **Characters**: A-Z, 0-9
- **Activation Limit**: 1 per license
- **Expires With**: Subscription

### License Metadata
```json
{
  "product": "pecu-premium",
  "version": "1.0",
  "features": [
    "automated_configurations",
    "advanced_security", 
    "performance_monitoring",
    "priority_support",
    "cloud_integrations",
    "advanced_gpu_features"
  ]
}
```

## Testing

### Test URLs
- Development: `https://pecu.tools/premium?license=PECU-TEST-TEST-TEST-TEST&email=test@example.com&order_id=test123`
- Production: `https://pecu.tools/premium?license=[license_key]&email=[email]&order_id=[order_id]`

### Test License Keys
Para testing durante desarrollo:
- `PECU-TEST-TEST-TEST-TEST` (siempre v√°lida)
- `PECU-DEMO-DEMO-DEMO-DEMO` (v√°lida por 7 d√≠as)

## Notas Importantes

1. **CORS**: Asegurar que `https://pecu.tools` est√© en la whitelist de CORS del API
2. **Rate Limiting**: Implementar rate limiting en `/api/v1/license/validate`
3. **Security**: Validar siempre las firmas de webhooks
4. **Grace Period**: 7 d√≠as de gracia despu√©s de cancelaci√≥n antes de revocar licencias
5. **Hardware Binding**: Cada licencia se vincula a un hardware_hash espec√≠fico

## Integration Checklist

- [ ] Configurar producto en Lemon Squeezy
- [ ] Configurar variantes de precios
- [ ] Configurar template de confirmaci√≥n modal
- [ ] Configurar template de email
- [ ] Configurar webhooks
- [ ] Probar flow completo en sandbox
- [ ] Configurar URLs de producci√≥n
- [ ] Validar integraci√≥n con API backend
- [ ] Probar validaci√≥n de licencias
- [ ] Verificar CORS en API
- [ ] Configurar rate limiting
- [ ] Probar webhooks de cancelaci√≥n/reembolso
